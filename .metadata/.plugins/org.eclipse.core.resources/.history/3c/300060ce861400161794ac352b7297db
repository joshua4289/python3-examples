

from scipy.stats import norm
import numpy as np
from scipy.sparse.linalg.isolve.lgmres import norm2
print norm.cdf(1.96)
# 
# array(0.97500210485177952)


def N(d):
    return norm.cdf(d)


stockPrice = S = 31.55
strikePrice = K = 22.75
timeUntilOptionExpiresInYears = t = 3.5
riskFreeInterestRate = r = 5.0 / 100.0
volitivity_as_percentage_per_annum = sigma = 50.0 / 100.0
cumulativeStandatdNormalDistribution = N = lambda d : norm.cdf(d)
days_per_year = T = 365.25
d1 = ( np.log(S/K) + (r + sigma**2/2.0)*t ) / (sigma * t**0.5)
d2 = d1 - sigma * t**0.5
normalProbabilityDensityFunction = npdf = np.exp(-d1**2/2) / (2 * np.pi)**0.5

CallOption = S * N(d1) - K * np.exp(-r*t) * N(d2)
PutOption = K * np.exp(-r*t) * N(-d2) - S * N(-d1)
CallDelta = N(d1)
PutDelta = N(d1) - 1
PutGamma = (1.0/(S * sigma * t**0.5)) * npdf
CallTheta = (-S * sigma * npdf / (2 * t**0.5) - r * K * np.exp(-r*t) * N(+d2)) / T
PutTheta  = (-S * sigma * npdf / (2 * t**0.5) + r * K * np.exp(-r*t) * N(-d2)) / T
PutVega = S * t**0.5 * npdf / 100
CallRho =  K * t * np.exp(-r*t) * N(+d2) / 100
PutRho  = -K * t * np.exp(-r*t) * N(-d2) / 100

def greeks(option, call_or_put, stockPrice, strikePrice, timeUntilExpiry, riskFreeInterestRate, volitivity):
    S = stockPrice
    K = strikePrice
    t = timeUntilExpiry
    r = riskFreeInterestRate / 100.0
    sigma = volitivity / 100.0
    days_per_year = T = 365.25
    
    d1 = ( np.log(S/K) + (r + sigma**2/2.0)*t ) / (sigma * t**0.5)
    d2 = d1 - sigma * t**0.5
    normalProbabilityDensityFunction = npdf = np.exp(-d1**2/2) / (2 * np.pi)**0.5


    def rho():
        if(call_or_put == "call"): return +K * t * np.exp(-r*t) * N(+d2) / 100
        if(call_or_put == "put"):  return -K * t * np.exp(-r*t) * N(-d2) / 100
    
    if option == "rho": return rho()

z = greeks("rho", "call",
    stockPrice = 31.55,
    strikePrice = 22.75,
    timeUntilExpiry = 3.5,
    riskFreeInterestRate = 5.0,
    volitivity = 50.0)
print "CallOption = {:.3f}".format(CallOption)
print "PutOption = {:.3f}".format(PutOption)
print "CallDelta = {:.3f}".format(CallDelta)
print "PutDelta = {:.3f}".format(PutDelta)
print "PutGamma = {:.6f}".format(PutGamma)
print "CallTheta = {:.6f}".format(CallTheta)
print "PutTheta = {:.6f}".format(PutTheta)
print "PutVega = {:.6f}".format(PutVega)
print "z", z
print "CallRho = {:.6f}".format(CallRho)
print "PutRho = {:.6f}".format(PutRho)
